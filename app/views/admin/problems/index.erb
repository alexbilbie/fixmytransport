<h2><%= t('admin.problems') %></h2>
<%= render :partial => "admin/shared/index_js" %>
<%= render :partial => "admin/shared/search_form", :locals => { :skip_transport_mode => true }  %>
<%= will_paginate @problems, { :admin => true } %>
<table class='problems index-list'>
  <tr>
    <th width='5%'><%= t('admin.id') %></th>
    <th width='10%'><%= t('admin.subject') %></th>
    <th width='10%'><%= t('admin.problem_campaign') %></th>
    <th width='10%'><%= t('admin.location') %></th>
    <th width='10%'><%= t('admin.transport_mode') %></th>
    <th width='10%'><%= t('admin.reporter') %></th>
    <th width='10%'><%= t('admin.responsible_org') %></th>
    <th width='5%'><%= t('admin.status') %></th>
    <th width='5%'><%= t('admin.created_at') %></th>
    <th width='5%'><%= t('admin.updated_at') %></th>
  </tr>
  <%-@problems.each do |problem| %>
    <tr class='<%= cycle("odd", "even") %>'>
      <td>
        <%- if problem.campaign %>
          <%= problem.id %>
        <%- else %>
          <%= link_to(problem.id, main_url(problem_path(problem)), :target => '_blank') %>
        <%- end %>
        <%= link_to("(#{t('admin.admin')})", admin_url(admin_problem_path(problem.id)), :target => '_blank') %></td>
      <td><%= problem.subject %></td>
      <td><%- if problem.campaign %><%= link_to(problem.campaign.title, admin_url(admin_campaign_path(problem.campaign)))%><%- end %></td>
      <td><%= link_to(problem.location.name, admin_location_url(problem.location))%></td>
      <td><%= problem.transport_mode_text %></td>
      <td><%= problem.reporter_name %></td>
      <td><%- if problem.operator %>
            <%= link_to(problem.operator.name, admin_operator_url(problem.operator.id)) %>
          <%- end %>
          <%- if problem.council_info%>
            <%= problem.council_info %>
          <%- end %>
          <%- if problem.passenger_transport_executive %>
            <%= link_to(problem.passenger_transport_executive.name, admin_pte_url(problem.passenger_transport_executive.id))%>
          <%- end %>
      </td>
      <td><%= problem.status %></td>
      <td><%= problem.created_at.to_s(:short) %></td>
      <td><%= problem.updated_at.to_s(:short) %></td>
    </tr>
  <%- end %>
</table>
<%= will_paginate @problems, { :admin => true } %>
